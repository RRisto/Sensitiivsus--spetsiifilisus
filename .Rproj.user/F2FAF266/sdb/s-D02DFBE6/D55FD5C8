{
    "contents" : "---\ntitle: \"Statistiline testimine\"\nauthor: \"Risto Hinno\"\ndate: \"August, 2015\"\noutput: html_document\n---\n\n##Sissejuhatus\n\nKäesoleva kirjatüki eesmärk on tõsta katet statiliselt testimiselt. Üritan joonistega (vähemalt minul on visuaalselt asjadest lihtsam aru saada, kui ainult valemeid vaadates) __endale__ selgitada, mida testimine ja sellega seotud mõisted endast kujutavad. Kui suudan statistilist testimist ka kellegi teise jaoks pisut selgemaks teha, on tegemist lisaboonusega. Kirjatüki lugemine tuleb kasuks, kui arst on teinud sulle kunagi mõne analüüsi või oled lugenud mõne kollasema väljaande nn teadusartikleid (näiteks \"Teaduslikult tõestatud: täiskuu mõjutab inimesi - ajab pisut pööraseks!\", \"Kanep ravib vähki\").\n\n##Algus\n\nOletame, et meid huvitab, kuidas eristada terveid inimesi neist, kellel on haigus (kuna ise arst pole, siis ei hakka tõe huvides ka ühtegi konkreetset haigust aluseks võtma, seda enam, et __andmed selles kirjatükis on simuleeritud__). Selleks, et haigust määrata, mõõdetakse veres oleva aine (markeri) Y kogust.\n\nAlgselt paneme paika __0-hüpoteesi: haigete ja tervete Y-i kogustes ei ole erinevusi__.\nPaneme paika ka __alternatiivse hüpoteesi (hüpotees, mis meile tegelikult huvi pakub): haigete Y-i kogused on suuremad kui tervetel__ (lihtsuse huvides määran efekti ka suuna, mitte lihtsalt ei ütle, et kogus on erinev).\n\nTervete inimeste puhul (10 000 proovi) on aine Y koguste jaotuse histogramm selline (lihtsuse huvides oletan, et see jaguneb vastavalt normaaljaotusele):\n\n\n```{r, cache=TRUE, echo=FALSE}\nvalues=data.frame(rnorm(n=10000, mean=4, sd=1))\nnames(values)=\"values\"\nlibrary(ggplot2)\nggplot(values, aes(x=values))+\n    geom_density(colour=\"grey\", fill=\"green\", alpha=0.1)+\n    xlab(\"Y-i kogus \")+\n    ylab(\"Tihedus\")+\n    theme_minimal()\n\n```\n\nTihedus näitab seda, milliseid Y-i koguseid on kõige rohkem (4 ühiku ümber on neid kõige rohkem, seal on ka mediaan ja keskmine). \n\nPaneme nüüd joonisele ka haigete Y-i kogused. \n\n```{r, cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}\n#funktsioon andmete simuleerimiseks\nandmetabel =function(mean1=4, mean2=6, sd1=1, sd2=1, nr1=10000, nr2=10000) {\n    library(dplyr)\n    #esimene grupp ehk terved\n    terved=rnorm(n=nr1, mean=mean1, sd=sd1) %>% \n        data.frame %>%\n        mutate(name=\"terved\")\n        \n    #teine grupp ehk haiged\n    haiged=rnorm(n=nr2, mean=mean2, sd=sd2) %>% \n        data.frame %>% \n        mutate(name=\"haiged\")\n    #paneme ühte tabelisse kokku\n    library(data.table)\n    data=rbind(terved, haiged)%>%\n        data.table\n    \n    names(data)[1]=c(\"value\")\n    data\n}\n#simuleerime andmed\nandmed=andmetabel(mean2=10)\n#paneme need graafikule\nggplot(subset(andmed,name==\"terved\") , aes(x=value))+\n    geom_density(colour=\"grey\",fill=\"green\", alpha=0.1)+\n    geom_density(data=subset(andmed,name==\"haiged\"), aes(x=value), \n                  colour=\"grey\", fill=\"red\", alpha=0.1)+\n    theme_minimal()+\n    xlab(\"Y-i kogus\")+\n    ylab(\"Tihedus\")+\n    coord_cartesian(ylim=c(0, 0.44))+\n    geom_text(data = NULL, x = 4, y = 0.42, label = \"terved\")+\n    geom_text(data = NULL, x = 10, y = 0.42, label = \"haiged\")+\n    geom_vline(xintercept=7, colour=\"blue\", size=1)\n\n```\n\nNagu jooniselt näha, on terved ja haiged Y-i koguste abil päris hästi eraldatavad (silmaga vaadates tundub, et nullhüpotees on ümber lükatud ja alternatiivne hüpotees tõestatud). Et haiged tervetest eraldada tõmbasin sinise joone. Vasakule jäävad (Y-i kogus on alla 7 ühiku) on terved ning paremale jäävad on haiged Nii suudame peaaegu 100%-lise täpsusega eraldada terved ja haiged. Milline ilus elu. \n\nReaalsus kipub aga olema selline:\n\n```{r, cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}\n#funktsioon graafiku tegemiseks\ngraafik=function(data=data, qt=0.95) {\n    \n    gg <- data[,list(x=density(value)$x, y=density(value)$y),by=\"name\"]\n    #piir, kus kohast tervete seas jääb qt% vaatlustest vasakule\n    #ehk test nätab, et on terved\n    sub=subset(data, name==\"terved\", select= c(value))\n    piir=quantile(sub$value, c(qt)) \n    library(ggplot2)\n    ggplot(data, aes(x=value))+\n        geom_density(aes(group=name), alpha=0.4)+\n        geom_ribbon(data=subset(gg,name==\"haiged\" & x<=piir),\n                    aes(x=x,ymax=y, fill=\"valenegatiivsed\"),ymin=0, alpha=0.4)+\n        geom_ribbon(data=subset(gg,name==\"terved\" & x>=piir),\n                    aes(x=x,ymax=y, fill=\"valepositiivsed\"),ymin=0, alpha=0.4)+\n        geom_vline(xintercept=piir, colour=\"blue\", size=1)+\n        scale_fill_discrete(name=\"\")+\n        xlab(\"Y-i kogus\")+\n        ylab(\"Tihedus\")+\n        theme_minimal()\n}\n\ngraafik(andmetabel())+\n    coord_cartesian(ylim=c(0, 0.44))+\n    geom_text(data = NULL, x = 4, y = 0.42, label = \"terved\")+\n    geom_text(data = NULL, x = 6.5, y = 0.42, label = \"haiged\")\n    \n```\n\nKuhu nüüd joon tõmmata? Kas nüüd on ka nullhüptees ümberlükatud? Õige vastus on, et oleneb olukorrast. Et sellele küsimusele vastata, peame seadme paika veapiiri, mida talume (__veapiir tuleb tegelikult enne andmete kogumist paika panna, mitte üritada seda andmetele peale vaadates kohendada__). Ma võtan aluseks tavaliselt näidetes kasutatava piiri, kus 95% tervetest jääb vasakule poole (nad klassifitseeritakse terveks). Sel juhul ainult 5% tervetest klassifitseeritakse haigeteks (nende puhul tehakse I tüüpi viga). __I tüüpi viga näitab, kui suur on tõenäosus, et leitakse erinevus näitajate vahel, kuigi erinevust tegelikkuses ei eksisteeri (tervete osakaal, kelle puhul test näitab, et nad on haiged)__. Joonisel kujutatud piiri järgi on ainult 5% terveid, keda test näitab haigetena. Need 5% on joonisel sinised ning neid kutsutakse valepositiivseteks (test on nende puhul positiivne ehk näitab et nad on haiged, kuigi tegelikult on terved). [Üldjuhul](https://en.wikipedia.org/wiki/P-value \"https://en.wikipedia.org/wiki/P-value\")  seataksegi I tüüpi vea piiriks 5% või 1% (ja kui küsida miks, siis ega erilist põhjendust olegi, võiks öelda, et traditsioon lihtsalt). \n\n##Asja teine külg ja point\nKuid sellest ei piisa. Me teame, kui suur on tõenäosus, et terve Y-i kogus on üle sinise joone  (maksimaalselt on see 5%, mis on meie talutava vea piires). __Kuid, kui suur on tõenäosus, et konkreetne üle sinise joone olev Y-i kogus on pärit haigete grupist?__ Mõnest muust grupist? Selle põhjal, et vaatlus ei kuulu tõenäoliselt tervete gruppi, ei saa järeldada, et see kuulub haigete gruppi (see oleks sama, kui hommikul peavaluga üles ärgates teha järeldus, et sul on ajuvähk. Aga äkki lihtsalt pohmell?). Kahjuks tehakse seda päris elus [tihti](http://www.nature.com/news/scientific-method-statistical-errors-1.14700 \"http://www.nature.com/news/scientific-method-statistical-errors-1.14700\").\n\nSiin tuleb mängu asja teine külg, ehk II tüüpi viga. Enne seda on meil vaja koguda paras hulk (meie näites 10 000) Y-i proove haigetelt. __II tüüpi viga ehk tõenäosus, et test ei näita erinevust, kuigi see tegelikult eksisteerib (haigete osakaal, kelle puhul test näitab, et nad on terved)__. Joonisel tähistab seda punane ala (valenegatiivsed: need, kelle puhul test näitab, et nad on terved, kuid tegelikult on nad haiged). Silmaga vaadates on näha, et selle vea tõenäosus tunduvalt suurem, kui oli I tüüpi veal (5%). Kui suur täpselt, näitab järgmine tabel, koos muude huvipakkuvate näitajatega:\n```{r, message=FALSE, warning=FALSE, cache=TRUE, echo=FALSE}\ntabel=function(data=data, qt=0.95) {\n    sub2=subset(data, name==\"terved\", select= c(value))\n    piir=quantile(sub2$value, c(qt)) \n    #õiged positiivsed (kes on haiged ja test seda ka näitab)\n    truepos=nrow(subset(data, name==\"haiged\" & value>piir))\n    #valepositiivsed, need, kes on terved, kuid test näitab haigena\n    falsepos=nrow(subset(data, name==\"terved\" & value>piir))\n    #õiged negatiivsed (kes on terved ja ka test nii näitab)\n    trueneg=nrow(subset(data, name==\"terved\" & value<=piir))\n    #valengeatiivsed (need, kes on haiged, kuid test näitab tervena)\n    falseneg=nrow(subset(data, name==\"haiged\" & value<=piir))\n    Näitaja=c(\"sensitiivsus (statistiline jõud)\", \"spetsiifilisus\", \n              \"valepositiivsete määr (I tüüpi vea määr)\", \n              \"valenegatiivsete määr (II tüüpi vea määr)\",\n              \"positiivne ennustatav väärtus\", \n            \"negatiivne ennustatav väärtus\")\n    Väärtus=c(round(truepos/(falseneg+truepos),3),\n                round(trueneg/(trueneg+falsepos),3),\n                1-round(trueneg/(trueneg+falsepos),3),\n                1-round(truepos/(falseneg+truepos),3),\n                round(truepos/(truepos+falsepos),3),\n                round(trueneg/(trueneg+falseneg),3))\n    data.frame(Näitaja, Väärtus)\n}\n#parema tabeli jaoks\nlibrary(knitr)\ntabel1=tabel(andmetabel())\nkable(tabel1, align=\"l\")\nsensitiivsus=tabel1[1,2]\nspetsiifilisus=tabel1[2,2]\nvaleposit=tabel1[3,2]\nvalenegat=tabel1[4,2]\npositpred=tabel1[5,2]\nnegatpred=tabel1[6,2]\n\n```\n\n- Testi __sensitiivsus (testi statistiline jõud)__ on `r sensitiivsus` ehk `r paste0(sensitiivsus*100, \"%\")` haigetel on Y-i kogus suurem, kui sinisega märgitud joon. Kui inimene on haige, siis suudame `r paste0(sensitiivsus*100, \"%\")` juhtudest teda praeguse testiga haigeks klassifitseerida. Ei ole just üleliia kõrge näitaja. Teadlaste hulgas on [arusaam](http://www.statisticsdonewrong.com/power.html \"http://www.statisticsdonewrong.com/power.html\"), et see näitaja võiks olla vähemalt 0.8 (80%).\n\n- __Spetsiifilisus__ on `r spetsiifilisus` ehk kui inimene on terve, siis `r paste0(spetsiifilisus*100, \"%\")` juhtudest suudame teda terveks klassifitseerida (`r paste0(spetsiifilisus*100, \"%\")` tervetel on Y-i kogus väiksem, kui sinise joonega määratud piir).\n\n- __Valepositiivsete määr (I tüüpi vea tõenäosus)__ kordame uuesti üle: terved, kelle puhul test näitab, et nad on haiged. Leitakse nii: 1 - spetsiifilisus. Käesoleval juhul `r valeposit` ehk `r paste0(valeposit*100, \"%\")`.\n\n- __Valenegatiivsete määr (II tüüpi vea tõenäosus)__ kordame uuesti üle: haiged, kelle puhul test näitab, et nad on terved. Leitakse nii: 1 - sensitiivsus. Käesoleval juhul `r valenegat` ehk `r paste0(valenegat*100, \"%\")`.\n\n- __Positiivne ennustatav väärtus__ ehk tõenäosus, et inimene on ka tegelikult haige, kui test seda näitab. Kui test näitab, et inimene on haige, siis `r paste0(positpred*100, \"%\")` juhtudel ta ka tegelikult on haige.\n\n- __Negatiivne ennustatav väärtus__ ehk tõenäosus, et kui test näitab, et inimene on terve, siis ta seda ka tegelikult on. Kui test näitab, et inimene on terve, siis `r paste0(negatpred*100, \"%\")` juhtudel ta ka tegelikult on terve.\n\n##Harutame asja lahti tabelina\n\nKui eelnev jäi segaseks, siis ehk aitab tabel koos järgnevate selgitustega asja selgitada:\n```{r, echo=FALSE, cache=TRUE}\npopulation=20000\nspec=spetsiifilisus\nsens=sensitiivsus\nratio=0.5 #haigete osakaal\n\nhaige=c(round(population*ratio*sens, 0), round(population*ratio*(1-sens), 0))\nterve=c(round(population*(1-ratio)*(1-spec), 0), round(population*(1-ratio)*spec, 0))\ntulem=c(\"test positiivne\", \"test negatiivne\")\ntest_summary=data.frame(tulem, haige, terve)\nkable(test_summary, align=\"l\")\noigepos=test_summary[1,2]\nvaleneg=test_summary[2,2]\nvalepos=test_summary[1,3]\noigeneg=test_summary[2,3]\n\n```\n\nTegemist on eelmise joonisega tabeli kujul. Kokku oli `r prettyNum(as.integer(population/2), big.mark=\" \")` tervet ja `r prettyNum(as.integer(population/2), big.mark=\" \")` haiget. Tervetest inimestest on test negatiivne (näitab, et on terved) `r oigeneg` puhul ning `r valepos` puhul test valetab, näidates, et inimene on haige (joonisel sinine ala). Haigete puhul on test aga ainult `r oigepos` puhul positiivne, ülejäänud `r valeneg` juhul test valetab, näidates, et inimene on terve (joonisel punane ala). \nSiit ka arvutusloogika eelnevate näitajate puhul (samad näitajad ja arvud, mis eelmises tabelis, kuid seekord koos valemitega): \n\n\n\n$$ \\begin{array}{ll} \n- \\mathbf {sensitiivsus\\;(testi \\; statistiline \\;jõud): } \\frac{õiged \\; positiivsed}{(õiged\\; positiivsed + valenegatiivsed)} = \\frac{`r oigepos`}{ (`r oigepos` + `r valeneg`)} = `r oigepos / (oigepos+valeneg)`  \\\\  \n- \\mathbf {spetsiifilisus:} \\frac{õiged \\; negatiivsed}{(õiged\\; negatiivsed + valepositiivsed)} = \\frac{`r oigeneg`}{ (`r oigeneg` + `r valepos`)} = `r oigeneg / (valepos+oigeneg)`  \\\\\n- \\mathbf {valepositiivsete \\; määr: } 1 - spetsiifilisus =\\frac{valepositiivsed}{(valepositiivsed + õiged \\;negatiivsed)} = \\frac{`r valepos`}{ (`r valepos` + `r oigeneg`)} = `r valepos / (valepos+oigeneg)`  \\\\\n- \\mathbf {valenegatiivsete \\; määr: } 1 - sensitiivsus =\\frac{valenegatiivsed}{(valenegatiivsed + õiged \\;negatiivsed)} = \\frac{`r valeneg`}{ (`r valeneg` + `r oigepos`)} = `r valeneg / (valeneg+oigepos)`  \\\\\n- \\mathbf {positiivne \\; ennustatav \\; väärtus: } \\frac{õiged \\; positiivsed}{(õiged \\; positiivsed + valepositiivsed)} = \\frac{`r oigepos`}{ (`r oigepos` + `r valepos`)} = `r round(oigepos / (oigepos+valepos),3)`   \\\\\n - \\mathbf {negatiivne \\; ennustatav \\; väärtus: } \\frac{õiged \\; negatiivsed}{(õiged \\; negatiivsed + valenegatiivsed)} = \\frac{`r oigeneg`}{ (`r oigeneg` + `r valeneg`)} = `r round(oigeneg / (oigeneg+valeneg),3)` \n  \\end{array} $$\n\nKui me nüüd teeme sulle testi ning saame Y-i koguseks 7 ühikut, siis meie [p-väärtus](https://en.wikipedia.org/wiki/P-value \"https://en.wikipedia.org/wiki/P-value\") (tõenäosus, et oled pärit tervete grupist) on alla seatud 0.05 (5%) piiri. Kokkuvõttes klassifitseeritakse sind haigeks (mis ei tähenda, et sa ei või tänu ebaõnnele ülla üks neist tervetest, kelle Y-i kogus on üle sinise joonega seatud piiri).\n\nEelneva mõte oli näidata, et ükski test pole 100% täpne. Kui test oli positiivne, siis oled `r paste0(positpred*100, \"%\")` tõenäosusega haige, kui test negatiivne, siis `r paste0(negatpred*100, \"%\")` tõenäosusega terve Tihtilugu räägitakse ajakirjanduses, et p-väärtusest (kui see on madal, siis on ükskõik kui jabur hüpotees justkui tõestatud). P-väärtus näitab ainult seda, kui tõenäoline on, et konkreetne vaatlus on pärit algsest jaotusest (meie puhul tervete grupist). Kui see on madal (alla 5% või 1%), siis võime suhtelise kindlusega väita, et konkreetne Y-i kogus pole suure tõenäosusega algsest jaotusest pärit. Ja ainult seda! P-väärtus ei näita mitte midagi selle kohta, kas konkreetne Y-i kogus on pärit haigete grupist. Seda näitab testi statistiline jõud, mis meie puhul pole ülemäära suur (kui inimene on haige, siis ainult ligi 2/3 juhtudest suudab seda test näidata). \n\n\nKui lähed järgmine kord arsti juurde ning ta teeb sulle mõne testi, siis küsi, mis on testi positiivne ennustatav väärtus (kui testi tulemus on positiivne) ja mis on testi negatiivne ennustatav väärtus (kui testi tulemus on negatiivne). \n\n##Juhe kokku\n\nKui eelnev oli segane, on mul positiivseid uudiseid, läheb aina hullemaks. \nVaatleme, kuidas haiguse leviku määr mõjutab testi positiivset ja negatiivset ennustatavat väärtust. \n\n```{r, cache=TRUE, echo=FALSE}\n#funktsioon, mis arvutab pos ja neg ennustatava väärtuse\nneg_pos_predictive=function(ratio, sensitivity, specificity) {\n    population=20000\n    haige=c(round(population*ratio*sensitivity, 0), round(population*ratio*(1-sensitivity), 0))\n    terve=c(round(population*(1-ratio)*(1-specificity), 0), round(population*(1-ratio)*specificity, 0))\n    tulem=c(\"test positiivne\", \"test negatiivne\")\n    test_summary=data.frame(tulem, haige, terve)\n    pospred=haige[1]/(haige[1]+terve[1])\n    negpred=terve[2]/(haige[2]+terve[2])\n    return(data.frame(pospred, negpred))\n}\n\n#simuleerime seda erinevate higete osakaalide juures\n###\nratiod=c(0.999,0.99,0.98,0.97,0.96,0.95,0.94,0.93,0.92,0.91,0.9,0.8, 0.7, \n          0.6,0.5, 0.4,0.3,0.2,0.1, 0.07, 0.05, 0.03, 0.01, 0.001)\n#tühi df kuhu andmed tulevad\nvastus= data.frame(positive_pred=numeric(),\n                    negative_pred=numeric())\n#panen sensitiivsuse ja spetsiifilusse paika\nsens=0.8\nspets=0.95\nfor (i in 1:length(ratiod)) {\n    vastus[i,]=neg_pos_predictive(ratio=ratiod[i], sensitivity = sens, specificity=spets)\n}\n#paneme ratiod juurde tulemite tabelisse\nvastus$ratio=ratiod\n#reshabime\nlibrary(reshape2)\nvastus=melt(vastus, id=c(\"ratio\"))\n#plotime\nlibrary(ggplot2)\nlibrary(scales) \nggplot(vastus, aes(x=ratio, y=value))+\n    geom_line(aes(colour=variable), size=1)+\n    xlab(\"haigete osakaal populatsioonist\")+\n    ylab(\"tõenäosus, et oled haige/terve\")+\n    ylab(\"\")+\n    scale_y_continuous(labels=percent)+\n    scale_x_continuous(labels=percent)+\n    guides(colour=guide_legend(title=NULL))+\n    scale_colour_discrete(breaks=c(\"positive_pred\", \"negative_pred\"),\n                         labels=c(\"Pos. ennust. väärtus\", \"Neg. ennust. väärtus\"))+\n    theme_minimal()\n```\n\nJoonisel olevad ennustatavad väärtused on arvutatud spetsiifilisusega `r spets` ja tundlikkusega `r sens`. Nagu näha, muutub positiivne ennustatav väärtus väikeseks, kui haigus on väga haruldane (mis on ka loogiline, mida haruldasem haiges, seda suurem ka tõenäosus, et mina olen terve). Negatiivne ennustatav väärtus muutub aga madalaks, kui haigus on väga levinud (jällegi on see loogiline, kuna mida rohkem haigus on levinud, seda suurem ka tõenäosus, et mina olen haige). \n\nEhk kui haigus on väga haruldane (näiteks 1% inimestest põeb seda), siis isegi kui testi tulemus on positiivne, on tõenäosus, et oled haige ainult 14%. Sama on juhul, kui haigus on väga levinud (näiteks 99% inimestest põeb seda), siis on negatiivse testi tulemuse korral ainult 5% tõenäosus, et oled terve. See on ka loogiline, kuna baasmäär on nii kõrge, et oleks üpris ebatõenäoline, et oled terve. Kui meil on aga rohkem infot sinu kohta, võib ka baasmäär muutuda (näiteks suitsetajate tõenäosus kopsuvähki haigestuda on oluliselt kõrgem kui mittesuitsetajatel). Seega tuleb lisaks testi tulemusele teada ka mingi nähtuse levikut (näiteks kui suudan testiga tõestada, et homöopaatia töötab, siis kuna eelnev baasmäär on väga madal, on testi tulemus tõenäoliselt lihtsalt juhuslik eksimus).\n\n##Statistiline jõud\n\nUurime, millest sõltub statistiline jõud (ehk sensitiivsus - tõenäosus, kui tervete ja haigete vahel on erinevus, siis meie test seda ka näitab). Algne statistiline jõud on `r sensitiivsus`. Vaatame, mis juhtub statistilise jõuga, kui muuta ühte näitajat korraga.\n\nKui me muudame haigete keskmise Y-i koguse 6-lt ühikult 8 ühikuni, siis saame sellise joonise:\n```{r, cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nmean_esimene=4\nmean_teine=8\nsd_esimene=1\nsd_teine=1\nnr_esimene=10000\nnr_teine=10000\nandmed=andmetabel(mean1=mean_esimene, mean2=mean_teine, sd1=sd_esimene, sd2=sd_teine, nr1=nr_esimene, nr2=nr_teine)\ngraafik(andmed)+\n    coord_cartesian(ylim=c(0, 0.44))+\n    geom_text(data = NULL, x = 4, y = 0.42, label = \"terved\")+\n    geom_text(data = NULL, x = 8, y = 0.42, label = \"haiged\")\n\npower=tabel(andmed)[1,2]\n```\n\n\nKui aga muuta ühe haigete Y-i koguste standardhälve ühelt ühikult 2-le, saame sellise joonise:\n```{r, cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nmean_esimene=4\nmean_teine=6\nsd_esimene=1\nsd_teine=2\nnr_esimene=10000\nnr_teine=10000\nandmed=andmetabel(mean1=mean_esimene, mean2=mean_teine, sd1=sd_esimene, sd2=sd_teine, nr1=nr_esimene, nr2=nr_teine)\ngraafik(andmed)+\n    coord_cartesian(ylim=c(0, 0.44))+\n    geom_text(data = NULL, x = 4, y = 0.42, label = \"terved\")+\n    geom_text(data = NULL, x = 8, y = 0.42, label = \"haiged\")\n\npower=tabel(andmed)[1,2]\n```\n\nJoonisel kujutatud olukorra puhul on testi statistiline jõud `r power`, mis on väiksem algsest. Uskuge mind, kui ka tervete Y-i koguste standarhälve muuta suuremaks, siis muutub statistiline jõud veelgi väiksemaks. Seega __mida suurem on näitajate standardhälve, seda väiksem on statistiline jõud__.\n\nKui suurendame tervete Y-i koguste hulka 10 000 proovilt 30 000 proovini, siis saame sellise joonise:\n```{r, cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nmean_esimene=4\nmean_teine=6\nsd_esimene=1\nsd_teine=1\nnr_esimene=30000\nnr_teine=10000\nandmed=andmetabel(mean1=mean_esimene, mean2=mean_teine, sd1=sd_esimene, sd2=sd_teine, nr1=nr_esimene, nr2=nr_teine)\ngraafik(andmed)+\n    coord_cartesian(ylim=c(0, 0.44))+\n    geom_text(data = NULL, x = 4, y = 0.42, label = \"terved\")+\n    geom_text(data = NULL, x = 7.5, y = 0.42, label = \"haiged\")\n\npower=tabel(andmed)[1,2]\n```\n\nJoonisel kujutatud olukorra puhul on testi statistiline jõud `r power`, mis on suurem algsest. Uskuge mind, kui suurendada ka haigete Y-i proovide hulk, kasvab statistiline jõud veeldi. Seega __mida suurem on valimi suurus, seda suurem on statistiline jõud__. Tasub tähele panna, et ajalehes avaldatud uuringutes on päris tihti uuringusse kaasatud valimi suurus 50 või isegi ainult 20 inimest/proovi. Seda on liiga vähe, et saaks järeldada midagi revolutsioonilist (nagu ajalehes olevad pealkirjad seda teevad).\n\nKui me tõstame I tüüpi vea (valepositiivsete) taluvuse piiri 5%-lt 1%-le, siis saame sellise joonise:\n\n```{r, cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nmean_esimene=4\nmean_teine=6\nsd_esimene=1\nsd_teine=1\nnr_esimene=30000\nnr_teine=10000\nandmed=andmetabel(mean1=mean_esimene, mean2=mean_teine, sd1=sd_esimene, sd2=sd_teine, nr1=nr_esimene, nr2=nr_teine)\ngraafik(andmed, qt=0.99)+\n    coord_cartesian(ylim=c(0, 0.44))+\n    geom_text(data = NULL, x = 4, y = 0.42, label = \"terved\")+\n    geom_text(data = NULL, x = 7.5, y = 0.42, label = \"haiged\")\n\npower=tabel(andmed, qt=0.99)[1,2]\n```\n\nJoonisel kujutatud olukorra puhul on testi statistiline jõud `r power`, mis on algsest tunduvalt väiksem. Seega __mida väiksem on I tüüpi vea piirmäär, seda väiksem on statistiline jõud__.\n\n\n##Kokkuvõte\n\nLoodan, et suutsin pisut selgemaks statistilise testimise tagamaid ja köögipoolt. Tegemist on väga lihtsustatud ja pinnapealse kirjatükiga, kuid enne kui hakata raketti ehitama, tuleb arusaada, mis põhiõttel asi töötab. Kui tahad näha graafikute ja tabelite loomiseks kasutatud koodi, siis selle leiad siit: https://github.com/RRisto/Sensitiivsus--spetsiifilisus/ \n\n##Kasutatud kirjandus\n\n[P-value. Wikipedia.](https://en.wikipedia.org/wiki/P-value \"https://en.wikipedia.org/wiki/P-value\")\n\n[Scientific method: Statistical errors. Nature](http://www.nature.com/news/scientific-method-statistical-errors-1.14700 \"http://www.nature.com/news/scientific-method-statistical-errors-1.14700\").\n\n[Statistical power and underpowered statistics. Statistics done wrong.](http://www.statisticsdonewrong.com/power.html \"http://www.statisticsdonewrong.com/power.html\")",
    "created" : 1440686795413.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3142924209",
    "id" : "D55FD5C8",
    "lastKnownWriteTime" : 1440698387,
    "path" : "C:/Users/Risto/OneDrive/Dokumendid/R/Sensitiivsus--spetsiifilisus/sens_spec_power.Rmd",
    "project_path" : "sens_spec_power.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}